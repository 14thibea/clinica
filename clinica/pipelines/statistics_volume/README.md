# `statistics-volume` - Statistics for volume

Perform 2-sample t-test on your NIfTI images generated by Clinica. 

## Dependencies
If you installed the docker image of Clinica, nothing is required. If you only installed the core of Clinica, this pipeline needs the installation of **SPM** on its standalone form or with **Matlab** on your computer. You can find how to install this software on the [installation](../#installing-clinica-from-source) page.


## Running the pipeline
The pipeline can be run with the following command line:

```
clinica run statistics-volume caps_directory subject_visits_with_covariates_tsv contrast feature_type group_id
```
where:

  - `caps_directory` is the output folder containing the results in a [CAPS](../CAPS) hierarchy.
  - `subject_visits_with_covariates_tsv` is the path to the TSV file with covariables (mandatory, unlike other Clinica pipelines)
  - `contrast` is the name of the contrast used to differntiate the 2 groups
  - `feature_type` indicates to Clinica what volume to use. It can be either `'fdg'` or `'graymatter'`. Use `'custom'` if you want to use the `--custom_files` flag.
  - `group_id` defines the group name for the anaysis

Optional parameters:

  - `--custom_files`: Custom file string. If you want to use a specific file in your CAPS folder, just specify its filename (use `*` when subject or session name appear). For example, if you want to use the file `sub-<subject_id>_ses-<session_id>_task-rest_acq-fdg_pet_space-Ixi549Space_pet.nii.gz` that is contained in `CAPS/subjects/sub-<subject_id>/ses-<session_id>/pet/preprocessing/group-<group_id>`, you can use the argument `*sub-*_ses-*_task-rest_acq-fdg_pet_space-Ixi549Space_pet.nii.gz`. If you want to specify the group, you can use `group-<group_id>/sub-*_ses-*_task-rest_acq-fdg_pet_space-Ixi549Space_pet.nii.gz
  - `--threshold_uncorrected_pvalue` sets the threshold for the uncorrected p-value (default value p = 0.001)
  - `--threshold_corrected_pvalue` sets the threshold for the corrected p-value (default value p = 0.05)
  - `--group_id_caps` is used when you have multiple groups in your CAPS, and Clinica is not able to determine what file to choose
  - `--smoothing` is the Full Width at Half Maximum (FWHM) of the smoothing used in your input file (by default 8 (mm))
## Outputs

Results are stored in the following folder of the [CAPS hierarchy](docs/CAPS): `groups/group-<group_id>/statistics/spm_2_sample_t_test` . Most important files are:

  - `participant.tsv`: list of subjects and sessions along with covariates (same file given in argument)
  - `spm_t-statistics_hypothesis-<group1>-less-than-<group2>.nii`: T statistics associated with the hypothesis group1 < group2 
  - `spm_t-statistics_hypothesis-<group2>-less-than-<group1>.nii`: T statistics associated with the hypothesis group2 < group1
  - `mask/included_voxel_mask.nii`: Voxels included in the analysis
  - `figures/spm_report-*.png`: All the results of the 2 sample t-test generated by SPM. Inmportant information are written there so that you can use StatisticsVolumeCorrection.
  - `regression_coeff/`: contains the coefficient of the regression for each element of the GLM
  - `variance_of_error`: contains the variance of the error.
  

The full list of output files can be found in the [ClinicA Processed Structure (CAPS) Specification](https://docs.google.com/document/d/14mjXbqRceHK0fD0BIONniLK713zY7DbQHJEV7kxqsd8/edit#heading=h.f4ddnk971gkn).


## Describing this pipeline in your paper
```
These results have been obtained with the pipeline statistics-volume of Clinica...
```